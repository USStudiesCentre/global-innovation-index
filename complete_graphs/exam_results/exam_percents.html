<!DOCTYPE html>
<meta charset="utf-8">
<title>Exam Results</title>
<body>
  <style>
    text {
			font-family: Univers LT Pro, sans-serif;
      font-size: 20px;
      fill: black;
    }

    div.container {
        height: 1000px;
        width: 1000px;
        border:none;
        resize:both;
       }
      #title{
        height: 100px;
        width: 1000px;
        border:none;
      }

    .title{text-anchor: "center";
         font-size: 32px;
         letter-spacing: -1px;
         text-rendering: optimizeLegibility;}
    
    .ussc_darkblue {
      fill: rgb(28,57,110);
      opacity:0.8;
    }
    
    .ussc_lightblue {
      fill: rgb(0,157,227);
      opacity: 0.8;
    }
    
    .ussc_darkred {
      fill: rgb(237,27,53);
      opacity: 0.8;
    }
 
 
    .hoods {
    fill:none;
    stroke-width:.3px;
    stroke:#fff;
  }

.state-borders {
  fill: none;
  stroke: #fff;
  stroke-width: 0.5px;
  stroke-linejoin: round;
  stroke-linecap: round;
  pointer-events: none;
}


  </style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
<script src="//d3js.org/queue.v1.min.js"></script>
<script src="//d3js.org/topojson.v1.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>

<script type="text/javascript">

 

var width = 1100,


    height = 300,
    τ = 2 * Math.PI; // http://tauday.com/tau-manifesto

// An arc function with all values bound except the endAngle. So, to compute an
// SVG path string for a given angle, we pass an object with an endAngle
// property to the `arc` function, and it will return the corresponding string.
var arc = d3.svg.arc()
    .innerRadius(40)
    .outerRadius(45)
    .startAngle(0);

// Create the SVG container, and apply a transform such that the origin is the
// center of the canvas. This way, we don't need to position arcs individually.
var svg = d3.select("body").append("svg")
    .attr("width", width + 500)
    .attr("height", height + 1000);


  // ACT:
var rings = [{id:"ussc_darkblue", type:"Reading proficiency", percent: 65},
             //{id:"ussc_lightblue", type:"Science proficiency", percent: 68},
             {id:"ussc_darkred", type: "Math proficiency", percent: 61}];
             // DC:
 var rings_dc = [{id:"ussc_darkblue", type:"Reading proficiency", percent: 19},
              //{id:"ussc_lightblue", type:"Science proficiency", percent: 0},
             {id:"ussc_darkred", type: "Math proficiency", percent: 9}];
var rings_ma = [{id:"ussc_darkblue", type:"Reading proficiency", percent: 46},
              //{id:"ussc_lightblue", type:"Science proficiency", percent: 0},
             {id:"ussc_darkred", type: "Math proficiency", percent: 51}];
var rings_nsw = [{id:"ussc_darkblue", type:"Reading proficiency", percent: 59},
              //{id:"ussc_lightblue", type:"Science proficiency", percent: 0},
             {id:"ussc_darkred", type: "Math proficiency", percent: 55}];
var d3Rings = []; 
  
var convertPercentToAngle = (percent) => { return ( percent / 100 ) * τ };    
  
var createRings = function(){  
  
  _.each(rings, function(ring,index){

    	var d3Ring = svg  
                .append("g")
                  .attr("transform", "translate(" + width / 2 + "," + ( ( 100 * index ) + 100) + ")")
                  .attr("id",ring.id);
    // background
    d3Ring
    .append("path")
    .datum({endAngle: τ})
    .style("fill", "#ddd")
    .attr("d", arc); 
    
    // foreground
    var foreground = d3Ring
    .append("path")
    .datum({endAngle: 0})
    .attr("class", ring.id)
		.style("stroke", "none")
		.style("stroke-width", "0px")
		.style("opacity", 0.8)
    .attr("d", arc);
    
    // text
    d3Ring
  	.append("text")
  	.attr("x", -22)
    .attr("y", 8) 
    .text(ring.percent + "%")
		.attr("class", ring.id);

    svg
    .append("text")
    .attr("x", 800)
    .attr("y", 205) 
    .text("Proficiency in math")
    .style("fill", "grey");

     svg
    .append("text")
    .attr("x", 800)
    .attr("y", 105) 
    .text("Proficiency in English")
    .style("fill", "grey");

    svg
    .append("text")
    .attr("x", 530)
    .attr("y", 45) 
    .text("ACT")
    .style("fill", "grey");

    svg
    .append("text")
    .attr("x", 650)
    .attr("y", 45) 
    .text("Washington DC")
    .style("fill", "grey");

    svg
    .append("text")
    .attr("x", 350)
    .attr("y", 45) 
    .text("NSW")
    .style("fill", "grey");

    svg
    .append("text")
    .attr("x", 140)
    .attr("y", 45) 
    .text("Massachusetts")
    .style("fill", "grey");


        svg
    .append("text")
    .attr("x", 330)
    .attr("y", 20) 
    .text("Literary and Numeric Proficiency")
    .style("fill", "black")
    .style("font-weight", "bold");

    svg
    .append("text")
    .attr("x", 140)
    .attr("y", 260) 
    .text("NB: Australia 2015 PISA (15-year-olds) used as reference, US used 2015 NAEP (8th grade results).")
    .style("font-size", "10px");
    
    
    
    var angle = convertPercentToAngle(ring.percent);
    
    foreground
    .transition()
      .duration(1500)
			.delay(1000 * index)
      .call(arcTween, angle);
    
    d3Rings.push(d3Ring);
  
  });  
}

createRings();


var createRings_dc = function(){  
  
  _.each(rings_dc, function(ring,index){

      var d3Ring = svg  
                .append("g")
                  .attr("transform", "translate(" + width / 1.5 + "," + ( ( 100 * index ) + 100 ) + ")")
                  .attr("id",ring.id);
    // background
    d3Ring
    .append("path")
    .datum({endAngle: τ})
    .style("fill", "#ddd")
    .attr("d", arc); 
    
    // foreground
    var foreground = d3Ring
    .append("path")
    .datum({endAngle: 0})
    .attr("class", ring.id)
    .style("stroke", "none")
    .style("stroke-width", "1px")
    .style("opacity", 0.8)
    .attr("d", arc);
    
    // text
    d3Ring
    .append("text")
    .attr("x", -22)
    .attr("y", 8) 
    .text(ring.percent + "%")
    .attr("class", ring.id);

      
    
    
    
    var angle = convertPercentToAngle(ring.percent);
    
    foreground
    .transition()
      .duration(1500)
      .delay(1000 * index)
      .call(arcTween, angle);
    
    d3Rings.push(d3Ring);
  
  });  
}

var createRings_nsw = function(){  
  
  _.each(rings_nsw, function(ring,index){

      var d3Ring = svg  
                .append("g")
                  .attr("transform", "translate(" + width / 3 + "," + ( ( 100 * index ) + 100 ) + ")")
                  .attr("id",ring.id);
    // background
    d3Ring
    .append("path")
    .datum({endAngle: τ})
    .style("fill", "#ddd")
    .attr("d", arc); 
    
    // foreground
    var foreground = d3Ring
    .append("path")
    .datum({endAngle: 0})
    .attr("class", ring.id)
    .style("stroke", "none")
    .style("stroke-width", "1px")
    .style("opacity", 0.8)
    .attr("d", arc);
    
    // text
    d3Ring
    .append("text")
    .attr("x", -22)
    .attr("y", 8) 
    .text(ring.percent + "%")
    .attr("class", ring.id);

      
    
    
    
    var angle = convertPercentToAngle(ring.percent);
    
    foreground
    .transition()
      .duration(1500)
      .delay(1000 * index)
      .call(arcTween, angle);
    
    d3Rings.push(d3Ring);
  
  });  
}
var createRings_ma = function(){  
  
  _.each(rings_ma, function(ring,index){

      var d3Ring = svg  
                .append("g")
                  .attr("transform", "translate(" + width / 6+ "," + ( ( 100 * index ) + 100 ) + ")")
                  .attr("id",ring.id);
    // background
    d3Ring
    .append("path")
    .datum({endAngle: τ})
    .style("fill", "#ddd")
    .attr("d", arc); 
    
    // foreground
    var foreground = d3Ring
    .append("path")
    .datum({endAngle: 0})
    .attr("class", ring.id)
    .style("stroke", "none")
    .style("stroke-width", "1px")
    .style("opacity", 0.8)
    .attr("d", arc);
    
    // text
    d3Ring
    .append("text")
    .attr("x", -22)
    .attr("y", 8) 
    .text(ring.percent + "%")
    .attr("class", ring.id);

      
    
    
    
    var angle = convertPercentToAngle(ring.percent);
    
    foreground
    .transition()
      .duration(1500)
      .delay(1000 * index)
      .call(arcTween, angle);
    
    d3Rings.push(d3Ring);
  
  });  
}
createRings();
createRings_dc();
createRings_ma();
createRings_nsw();
function arcTween(transition, newAngle) {

  transition.attrTween("d", function(d) {  
  var interpolate = d3.interpolate(d.endAngle, newAngle);

    return function(t) {
      d.endAngle = interpolate(t);
      return arc(d);
    };
  });
}


</script>



